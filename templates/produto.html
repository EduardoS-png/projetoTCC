{% extends 'layout.html' %} {% block main %}

<section id="inventario">
  <div id="inventarioCabecalho">
    <h2 class="paginaTitulo">Produtos</h2>
  </div>

  <div id="controlesInventario">
    <button id="btnAbrirModalProduto" class="botaoPrimario">
      <img
        src="{{ url_for('static', filename='assets/icons/novo.svg') }}"
        alt="novo.svg"
      />Novo produto
    </button>

    <div class="filtros">
      <input type="text" id="filtroNome" placeholder="Filtrar por nome..." />

      <select id="filtroCategoria">
        <option value="">Todas as categorias</option>
        {% for categoria in categorias %}
        <option value="{{ categoria['id'] }}">{{ categoria['nome'] }}</option>
        {% endfor %}
      </select>

      <select id="filtroStatus">
        <option value="todos" {% if status == 'todos' %}selected{% endif %}>Todos</option>
        <option value="ativo" {% if status == 'ativo' %}selected{% endif %}>Ativos</option>
        <option value="inativo" {% if status == 'inativo' %}selected{% endif %}>Inativos</option>
      </select>
    </div>
  </div>

  <h3 class="tituloTabela">Tabela dos produtos cadastrados</h3>
  <div class="table-container">
    <table id="tabelaProdutos" class="tabelaInventario">
      <thead>
        <tr class="tabelaCabecalho">
          <th title="ID">ID</th>
          <th title="Nome">Nome</th>
          <th title="Categoria">Categoria</th>
          <th title="Código Original">Código Original</th>
          <th title="Marca">Marca</th>
          <th title="Tamanho">Tamanho</th>
          <th title="Cor">Cor</th>
          <th title="Data Cadastro">Data Cadastro</th>
          <th title="Status">Status</th>
          <th title="Ações">Ações</th>
        </tr>
      </thead>
      <tbody>
        {% for produto in produtos %}
        <tr
          data-categoria-id="{{ produto['categoria_id'] }}"
        >
          <td title="{{ produto['id'] }}">{{ produto['id'] }}</td>
          <td title="{{ produto['nome'] }}">{{ produto['nome'] }}</td>
          <td title="{{ produto['categoria'] }}">{{ produto['categoria'] }}</td>
          <td title="{{ produto['codigo_original'] }}">{{ produto['codigo_original'] }}</td>
          <td title="{{ produto['marca'] }}">{{ produto['marca'] }}</td>
          <td title="{{ produto['tamanho'] }}">{{ produto['tamanho'] }}</td>
          <td title="{{ produto['cor'] }}">{{ produto['cor'] }}</td>
          <td title="{{ produto['data_cadastro'] }}">{{ produto['data_cadastro'] }}</td>
          <td>
            <span
              class="badge-status {{ 'badge-ativo' if produto.ativo == 1 else 'badge-inativo' }}"
            >
              {{ 'Ativo' if produto.ativo == 1 else 'Inativo' }}
            </span>
          </td>
          <td>
            <button
              class="botoesDecisao btnAbrirModalAlterarProduto"
              href=""
              title="Abrir editar"
              data-id="{{ produto['id'] }}"
            >
              <img src="/static/assets/icons/editar.svg" alt="editar" />
            </button>
            {% if produto['ativo'] == 1 %}
            <a
              class="botoesDecisao"
              title="Inativar"
              href="{{url_for('produto.inativar_produto',id=produto['id'])}}"
            >
              <img src="/static/assets/icons/inativar.svg" alt="inativar" />
            </a>
            {% else %}
            <a
              class="botoesDecisao"
              title="Reativar"
              href="{{url_for('produto.reativar_produto',id=produto['id'])}}"
            >
              <img src="/static/assets/icons/reativar.svg" alt="reativar" />
            </a>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>

<!-- MODAL CADASTRO -->
<dialog id="modalCadastroProduto">
  <form id="formCadastroProduto" method="POST" action="/produto/cadastrar">
    <div class="modalCabecalho">
      <h2 class="tituloModal">Novo Produto</h2>
      <button
        type="button"
        aria-label="Fechar formulário"
        id="botaoFecharProduto"
      >
        <img
          src="{{ url_for('static', filename='assets/icons/fechar.svg')}}"
          alt="fechar"
        />
      </button>
    </div>

    <label for="nomeCadastro">Nome do Produto</label>
    <input
      type="text"
      id="nomeCadastro"
      name="nome"
      placeholder="Digite o nome do produto..."
      required
    />

    <label for="categoriaCadastro">Categoria do Produto</label>
    <select id="categoriaCadastro" name="categoria_id" required>
      <option value="">Selecione a categoria</option>
      {% for categoria in categorias %}
      <option value="{{categoria['id']}}">{{categoria['nome']}}</option>
      {% endfor %}
    </select>

    <label for="codigoCadastro">Código</label>
    <input
      type="text"
      id="codigoCadastro"
      name="codigo_original"
      placeholder="Digite o código do produto..."
      required
    />

    <label for="marcaCadastro">Marca</label>
    <input
      type="text"
      id="marcaCadastro"
      name="marca"
      placeholder="Digite a marca..."
    />

    <label for="tamanhoCadastro">Tamanho</label>
    <input
      type="text"
      id="tamanhoCadastro"
      name="tamanho"
      placeholder="Digite o tamanho..."
    />

    <label for="corCadastro">Cor</label>
    <input
      type="text"
      id="corCadastro"
      name="cor"
      placeholder="Digite a cor..."
    />

    <label for="dataCadastro">Data de Cadastro</label>
    <input type="date" id="dataCadastro" name="data_cadastro" required />

    <menu>
      <button type="submit" class="botaoPrimario">Salvar</button>
      <button type="button" id="botaoCancelarCadastro">Cancelar</button>
    </menu>
  </form>
</dialog>

<!-- MODAL ALTERAR -->
<dialog id="modalAlterarProduto">
  <form id="formAlterarProduto" method="POST" action="/produto/alterar">
    <div class="modalCabecalho">
      <h2 class="tituloModal">Alterar Produto</h2>
      <button type="button" aria-label="Fechar formulário" id="botaoFecharAlterar">
        <img src="{{ url_for('static', filename='assets/icons/fechar.svg')}}" alt="fechar" />
      </button>
    </div>

    <input type="hidden" id="idAlterar" name="id" />

    <label for="nomeAlterar">Nome do Produto</label>
    <input type="text" id="nomeAlterar" name="nome" required />

    <label for="categoriaAlterar">Categoria do Produto</label>
    <select id="categoriaAlterar" name="categoria_id" required>
      {% for categoria in categorias %}
      <option value="{{categoria['id']}}">{{categoria['nome']}}</option>
      {% endfor %}
    </select>

    <label for="codigoAlterar">Código</label>
    <input type="text" id="codigoAlterar" name="codigo_original" required />

    <label for="marcaAlterar">Marca</label>
    <input type="text" id="marcaAlterar" name="marca" />

    <label for="tamanhoAlterar">Tamanho</label>
    <input type="text" id="tamanhoAlterar" name="tamanho" />

    <label for="corAlterar">Cor</label>
    <input type="text" id="corAlterar" name="cor" />

    <label for="dataAlterar">Data de Cadastro</label>
    <input type="date" id="dataAlterar" name="data_cadastro" required />

    <menu>
      <button type="submit" class="botaoPrimario">Salvar</button>
      <button type="button" id="botaoCancelarAlterar">Cancelar</button>
    </menu>
  </form>
</dialog>


{% endblock %} {% block javascript %}
<script
  type="module"
  src="{{ url_for('static', filename='js/produto.js') }}"
></script>
{% endblock %}
